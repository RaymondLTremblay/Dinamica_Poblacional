<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>compadre_orchids – Diagnostico Poblacional</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./120-Traduccion_protocolo_informacion.html" rel="next">
<link href="./116-Estudio_evolutivos.qmd" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0309b8b1721542f374478695392ebb2d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-083d847ecde08941f1699ed9c8914ce7.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Diagnostico Poblacional">
<meta property="og:description" content="">
<meta property="og:image" content="119-COMPADRE_ORCHIDS_files/figure-html/Compr18-1.png">
<meta property="og:site_name" content="Diagnostico Poblacional">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Capítulos</a></li><li class="breadcrumb-item"><a href="./119-COMPADRE_ORCHIDS.html">COMPADRE y Orquídeas</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/MPP_Hex.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://raymondltremblay.github.io/Dinamica_Poblacional" title="Analitica Fundación" class="quarto-navigation-tool px-1" aria-label="Analitica Fundación"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Capítulos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./102-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./103-Ciclos_de_Vida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ciclos de Vida</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./104-Recopilacion_datos_en_el_campo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recopilación de datos en el campo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./105-Transiciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calcular transiciones</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./106-calcular_fecundidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calcular fecundidad</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./107-matU_matF_matC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Suma de matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./108-Bayesian_PPM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimados bayesianos de PPM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./109-Crecimiento_poblacional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crecimiento poblacional</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./110-Indices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Índices demográficos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./111-Elasticidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Elasticidad</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./112-Dinamica_de_Transiciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dinámica de Transiciones</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./113-Funciones_de_Transferencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Funciones de Transferencia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./114-LTRE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimento de Respuesta de Tabla de Vida</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./115-Metodod_de_simulaciones.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Método de Simulaciones</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./116-Estudio_evolutivos.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estudios evolutivos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./119-COMPADRE_ORCHIDS.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">COMPADRE y Orquídeas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./120-Traduccion_protocolo_informacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Traducción del protocolo de información</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./121-Impacto_de_Datos_sin_Sentido.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Impacto de Datos sin Sentido Biológico</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./131-Dinamica_de_Transiciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dinámica de Transiciones2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./132-Capitulos_Asignados.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Capítulos Asignados</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Ejemplo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./122-Nhora_Dracula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dinámica de Dracula</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Historia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./117-Historia_breve.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Historia breve de la demografía en orquidea</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./118-Carl_Olaf_Tamm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Carl Olaf Tamm</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendix_A_Species_List.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lista de Especies de Orquídeas en COMPADRE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendix_B_Hoja_de_datos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hoja de datos</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#Compadre" id="toc-Compadre" class="nav-link active" data-scroll-target="#Compadre">COMPADRE y Orquideas</a>
  <ul class="collapse">
  <li><a href="#activar-los-siguiente-paquetes" id="toc-activar-los-siguiente-paquetes" class="nav-link" data-scroll-target="#activar-los-siguiente-paquetes">Activar los siguiente paquetes</a>
  <ul class="collapse">
  <li><a href="#acceso-a-los-datos-de-compadre." id="toc-acceso-a-los-datos-de-compadre." class="nav-link" data-scroll-target="#acceso-a-los-datos-de-compadre.">Acceso a los datos de COMPADRE.</a></li>
  <li><a href="#filtrar-para-la-familia-de-orquidaceae" id="toc-filtrar-para-la-familia-de-orquidaceae" class="nav-link" data-scroll-target="#filtrar-para-la-familia-de-orquidaceae">Filtrar para la familia de Orquidaceae</a></li>
  <li><a href="#cual-son-los-géneros-de-la-familia-orchidaceae" id="toc-cual-son-los-géneros-de-la-familia-orchidaceae" class="nav-link" data-scroll-target="#cual-son-los-géneros-de-la-familia-orchidaceae">Cual son los géneros de la familia Orchidaceae</a></li>
  <li><a href="#lista-de-especies-únicas-de-orquídeas-en-la-base-de-datos-de-compadre." id="toc-lista-de-especies-únicas-de-orquídeas-en-la-base-de-datos-de-compadre." class="nav-link" data-scroll-target="#lista-de-especies-únicas-de-orquídeas-en-la-base-de-datos-de-compadre.">Lista de especies únicas de orquídeas en la base de datos de COMPADRE.</a></li>
  </ul></li>
  <li><a href="#contabilizar-cuantas-matrices-y-variables-estan-incluidas-en-el-archivo" id="toc-contabilizar-cuantas-matrices-y-variables-estan-incluidas-en-el-archivo" class="nav-link" data-scroll-target="#contabilizar-cuantas-matrices-y-variables-estan-incluidas-en-el-archivo">Contabilizar cuantas matrices y variables estan incluidas en el archivo</a>
  <ul class="collapse">
  <li><a href="#la-fuente-de-la-información" id="toc-la-fuente-de-la-información" class="nav-link" data-scroll-target="#la-fuente-de-la-información">La fuente de la información</a></li>
  </ul></li>
  <li><a href="#frecuencia-de-autores-unicos-en-la-base-de-datos" id="toc-frecuencia-de-autores-unicos-en-la-base-de-datos" class="nav-link" data-scroll-target="#frecuencia-de-autores-unicos-en-la-base-de-datos">Frecuencia de autores unicos en la base de datos</a></li>
  <li><a href="#roberto" id="toc-roberto" class="nav-link" data-scroll-target="#roberto"><em>ROBERTO</em>:</a></li>
  <li><a href="#extraer-información-de-una-especie-específica" id="toc-extraer-información-de-una-especie-específica" class="nav-link" data-scroll-target="#extraer-información-de-una-especie-específica">Extraer información de una especie específica</a></li>
  <li><a href="#extraer-la-matriz" id="toc-extraer-la-matriz" class="nav-link" data-scroll-target="#extraer-la-matriz">Extraer la matriz</a></li>
  <li><a href="#cuantos-estudios-unicos" id="toc-cuantos-estudios-unicos" class="nav-link" data-scroll-target="#cuantos-estudios-unicos">Cuantos estudios unicos?</a>
  <ul class="collapse">
  <li><a href="#determinar-cuantas-poblaciones-fueron-muestreadas-por-especies" id="toc-determinar-cuantas-poblaciones-fueron-muestreadas-por-especies" class="nav-link" data-scroll-target="#determinar-cuantas-poblaciones-fueron-muestreadas-por-especies">Determinar cuantas poblaciones fueron muestreadas por especies</a></li>
  <li><a href="#cuan-largo-fueron-los-estudios" id="toc-cuan-largo-fueron-los-estudios" class="nav-link" data-scroll-target="#cuan-largo-fueron-los-estudios">¿Cuan largo fueron los estudios?</a></li>
  <li><a href="#tiempo-de-duración-de-las-investigaciones." id="toc-tiempo-de-duración-de-las-investigaciones." class="nav-link" data-scroll-target="#tiempo-de-duración-de-las-investigaciones.">Tiempo de duración de las investigaciones.</a></li>
  <li><a href="#evaluación-de-cumplimiento-de-condiciones" id="toc-evaluación-de-cumplimiento-de-condiciones" class="nav-link" data-scroll-target="#evaluación-de-cumplimiento-de-condiciones">Evaluación de cumplimiento de condiciones</a></li>
  <li><a href="#ahora-usando-las-matrices-que-cumple-con-las-condiciones-de-ergodicidad-y-irreducbilidad-se-puede-calcular-el-valor-propio-de-lambda." id="toc-ahora-usando-las-matrices-que-cumple-con-las-condiciones-de-ergodicidad-y-irreducbilidad-se-puede-calcular-el-valor-propio-de-lambda." class="nav-link" data-scroll-target="#ahora-usando-las-matrices-que-cumple-con-las-condiciones-de-ergodicidad-y-irreducbilidad-se-puede-calcular-el-valor-propio-de-lambda.">Ahora usando las matrices que cumple con las condiciones de ergodicidad y irreducbilidad se puede calcular el valor propio de lambda.</a></li>
  <li><a href="#cambiar-el-estado-de-algunas-variables" id="toc-cambiar-el-estado-de-algunas-variables" class="nav-link" data-scroll-target="#cambiar-el-estado-de-algunas-variables">Cambiar el estado de algunas variables</a></li>
  <li><a href="#se-cambia-todas-las-caladenia-de-epifitas-a-terrestres" id="toc-se-cambia-todas-las-caladenia-de-epifitas-a-terrestres" class="nav-link" data-scroll-target="#se-cambia-todas-las-caladenia-de-epifitas-a-terrestres">Se cambia todas las <em>Caladenia</em> de epifitas a terrestres</a></li>
  </ul></li>
  <li><a href="#resolve-the-name-of-this-data-frame-give-it-a-more-reasonable-name" id="toc-resolve-the-name-of-this-data-frame-give-it-a-more-reasonable-name" class="nav-link" data-scroll-target="#resolve-the-name-of-this-data-frame-give-it-a-more-reasonable-name">Resolve the name of this data frame… Give it a more reasonable name</a></li>
  <li><a href="#variación-en-crecimiento-de-la-popblación-en-epifitas" id="toc-variación-en-crecimiento-de-la-popblación-en-epifitas" class="nav-link" data-scroll-target="#variación-en-crecimiento-de-la-popblación-en-epifitas">Variación en crecimiento de la popblación en <em>Epifitas</em></a>
  <ul class="collapse">
  <li><a href="#la-cantidad-de-poblaciones-por-especies-en-la-base-de-datos-de-compadre." id="toc-la-cantidad-de-poblaciones-por-especies-en-la-base-de-datos-de-compadre." class="nav-link" data-scroll-target="#la-cantidad-de-poblaciones-por-especies-en-la-base-de-datos-de-compadre.">La cantidad de poblaciones por especies en la base de datos de COMPADRE.</a></li>
  </ul></li>
  <li><a href="#usando-leaflet-para-mapar-de-distribución-interactivo" id="toc-usando-leaflet-para-mapar-de-distribución-interactivo" class="nav-link" data-scroll-target="#usando-leaflet-para-mapar-de-distribución-interactivo">Usando leaflet para mapar de distribución interactivo</a></li>
  <li><a href="#la-esperanza-de-vida-de-las-orquídeas" id="toc-la-esperanza-de-vida-de-las-orquídeas" class="nav-link" data-scroll-target="#la-esperanza-de-vida-de-las-orquídeas">La esperanza de vida de las orquídeas</a>
  <ul class="collapse">
  <li><a href="#calcular-el-promedio-y-la-varianza-en-la-expectativa-de-vida-de-un-modelo-de-matriz-poblacional" id="toc-calcular-el-promedio-y-la-varianza-en-la-expectativa-de-vida-de-un-modelo-de-matriz-poblacional" class="nav-link" data-scroll-target="#calcular-el-promedio-y-la-varianza-en-la-expectativa-de-vida-de-un-modelo-de-matriz-poblacional">Calcular el promedio y la varianza en la expectativa de vida de un modelo de matriz poblacional</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Capítulos</a></li><li class="breadcrumb-item"><a href="./119-COMPADRE_ORCHIDS.html">COMPADRE y Orquídeas</a></li></ol></nav></header>




<section id="Compadre" class="level1">
<h1>COMPADRE y Orquideas</h1>
<p>Raymond y Roberto</p>
<p>Uno de los esfuerzos más grandes en la ecología de poblaciones es la base de datos de COMPADRE y COMADRE. COMPADRE es una base de datos de matrices de transición de estados de poblaciones de plantas y COMADRE es una base de datos de matrices de transición de estados de poblaciones de animales. Estas bases de datos son una fuente de información para evaluar la dinámica de poblaciones de plantas y animales. En este capítulo se presenta una introducción a la base de datos de COMPADRE y algunas de las funciones en los paquetes de <strong>Rcompadre</strong> y <strong>Rage</strong>. La información aquí no sustituye la información provista en la página web de COMPADRE &lt;<a href="https://compadre-db.org/" class="uri">https://compadre-db.org/</a>&gt; y los tutoriales que se encuentran en la siguiente página &lt;<a href="https://compadre-db.org/Education" class="uri">https://compadre-db.org/Education</a>&gt;.</p>
<p>El valor de las bases de datos es tener en un mismo sitio una gran cantidad de información donde la información este organizado de la misma manera y accesible en adición a tener la información en un formato que se puede usar en análisis. En el caso de COMPADRE y COMADRE, la información esta organizada en matrices de transición de estados de poblaciones (MPM) que se pueden usar para evaluar la dinámica de poblaciones de plantas y animales y con múltiples variables, tal como sus coordinadas geográficas, el tipo de hábitat, la duración de los estudios, la fuente de la información, entre otros.</p>
<p>En este capítulo se aprende a utiliza la base de datos de COMPADRE para evaluar la dinámica de poblaciones de orquídeas. Se evalúa como extraer diferentes tipos de datos para responder a preguntas específicas.</p>
<section id="activar-los-siguiente-paquetes" class="level2">
<h2 class="anchored" data-anchor-id="activar-los-siguiente-paquetes">Activar los siguiente paquetes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcompadre) <span class="co"># Paquete para trabajar con la base de datos de COMPADRE y COMADRE</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Paquete para activar multiples paquetes</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># Paquete para formatear tablas</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Paquete para formatear tablas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="acceso-a-los-datos-de-compadre." class="level3">
<h3 class="anchored" data-anchor-id="acceso-a-los-datos-de-compadre.">Acceso a los datos de COMPADRE.</h3>
<section id="bajando-el-archivo-de-datos" class="level4">
<h4 class="anchored" data-anchor-id="bajando-el-archivo-de-datos">Bajando el archivo de datos</h4>
<p>Hay dos métodos de tener acceso a los datos de COMPADRE (datos de dinámica poblacional de plantas) y COMADRE (datos de dinámica poblacional de animales). Los datos se pueden accesar directamente de la pagina de web o bajar el archivo de datos al siguiente enlace &lt;<a href="https://compadre-db.org/Data/Compadre" class="uri">https://compadre-db.org/Data/Compadre</a>&gt; seleccionando la pestaña de <strong>Download COMPADRE</strong> o <strong>Download COMADRE</strong>.</p>
<p>Para tener acceso a los datos cuando no esta conectado al internet es necesario bajar el archivo y subirlos en su proyecto de RStudio. Al momento de construir el libro la versión más reciente de COMPADRE es la versión 6.23.5.5.0 (May_06_2023) y se puede bajar al siguiente enlace &lt;&lt;https://compadre-db.org/Data/Compadre/COMPADRE_v.</p>
<section id="acesso-a-los-datos-de-su-computadora" class="level5">
<h5 class="anchored" data-anchor-id="acesso-a-los-datos-de-su-computadora">Acesso a los datos de su computadora</h5>
<ul>
<li>USAR el código siguiente si tiene los datos bajado a su computadora.</li>
</ul>
<p>load(dirección/al/archivo/a/su/proyecto/de/RStudio) si tiene el repositorio en su computadora (preferiblemente en su proyecto de RStudio)</p>
<hr>
</section>
</section>
<section id="rastreando-los-datos-con-el-enlace-de-web" class="level4">
<h4 class="anchored" data-anchor-id="rastreando-los-datos-con-el-enlace-de-web">Rastreando los datos con el enlace de web</h4>
<ul>
<li>Usando la función <em>cdb_fetch()</em> se puede bajar los datos directamente de la pagina de web de COMPADRE. Esta función se encuentra en el paquete de <strong>Rcompadre</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>compadre <span class="ot">&lt;-</span> <span class="fu">cdb_fetch</span>(<span class="st">"compadre"</span>) <span class="co"># Usar este código para bajar los datos del repositorio de COMPADRE.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is COMPADRE version 6.23.5.0 (release date May_06_2023)
See user agreement at https://compadre-db.org/Help/UserAgreement
See how to cite with `citation(Rcompadre)`</code></pre>
</div>
</div>
</section>
<section id="renombrar-la-base-datos-a-algo-sencillo" class="level4">
<h4 class="anchored" data-anchor-id="renombrar-la-base-datos-a-algo-sencillo">Renombrar la base datos a algo sencillo</h4>
<ul>
<li>En este script se renombrar la base de datos de COMPADRE a algo más sencillo <strong>TodasSp</strong>, reemplazando <strong>compadre</strong>.</li>
<li>Se visualiza el nombre de cada columna en la base de datos.
<ul>
<li>Hay 59 variables en la base de datos de COMPADRE.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TodasSp=as_cdb(compadre)  # Un paso critico: Convertir la base de datos anterior COM(P)ADRE (de clase 'list') en la base en un objeto CompadreDB (COMPADRE Database)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>TodasSp<span class="ot">=</span>compadre</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(TodasSp) <span class="co"># La lista de los nombres de las variables en el archivo COMPADRE, Nota que 59 variables en la base de datos de COMPADRE.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "mat"                    "MatrixID"               "SpeciesAuthor"         
 [4] "SpeciesAccepted"        "CommonName"             "Kingdom"               
 [7] "Phylum"                 "Class"                  "Order"                 
[10] "Family"                 "Genus"                  "Species"               
[13] "Infraspecies"           "InfraspeciesType"       "OrganismType"          
[16] "DicotMonoc"             "AngioGymno"             "Authors"               
[19] "Journal"                "SourceType"             "OtherType"             
[22] "YearPublication"        "DOI_ISBN"               "AdditionalSource"      
[25] "StudyDuration"          "StudyStart"             "StudyEnd"              
[28] "ProjectionInterval"     "MatrixCriteriaSize"     "MatrixCriteriaOntogeny"
[31] "MatrixCriteriaAge"      "MatrixPopulation"       "NumberPopulations"     
[34] "Lat"                    "Lon"                    "Altitude"              
[37] "Country"                "Continent"              "Ecoregion"             
[40] "StudiedSex"             "MatrixComposite"        "MatrixSeasonal"        
[43] "MatrixTreatment"        "MatrixCaptivity"        "MatrixStartYear"       
[46] "MatrixStartSeason"      "MatrixStartMonth"       "MatrixEndYear"         
[49] "MatrixEndSeason"        "MatrixEndMonth"         "CensusType"            
[52] "MatrixSplit"            "MatrixFec"              "Observations"          
[55] "MatrixDimension"        "SurvivalIssue"          "_Database"             
[58] "_PopulationStatus"      "_PublicationStatus"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(TodasSp) <span class="co"># La base de datos de COMPADRE tiene 8994 filas y 59 columnas (variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8994   59</code></pre>
</div>
</div>
<hr>
</section>
<section id="evaluar-si-un-genero-o-especie-este-en-la-base-de-datos-de-compadre" class="level4">
<h4 class="anchored" data-anchor-id="evaluar-si-un-genero-o-especie-este-en-la-base-de-datos-de-compadre">Evaluar si un genero o especie este en la base de datos de COMPADRE</h4>
<ul>
<li>Para filtrar un genero específico se puede usar el siguiente código.
<ul>
<li>Aquí seleccionamos todas las matrices del genero <strong>Epipactis</strong>.</li>
<li>Nota que hay 59 filas, que corresponde típicamente a 59 matrices de diferentes poblaciones, tiempo o un análisis teóricos.</li>
</ul></li>
</ul>
<p><strong>This shows that the species added <em>Epidendrum xanthinum</em> is not yet included in the data base</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Epi <span class="ot">=</span> TodasSp <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Genus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Epipactis"</span>)) <span class="co"># Filtrar la información de *Epipactis* en la base de datos.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Epi <span class="co"># Nota que en el genero *Epipactis*, tenemos 51 fila, pero todas son de la misma especie de dos estudios distintos. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 1 SPECIES and 51 MATRICES.

# A tibble: 51 × 59
   mat        MatrixID SpeciesAuthor   SpeciesAccepted CommonName Kingdom Phylum
   &lt;list&gt;        &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
 1 &lt;CompdrMt&gt;   238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 2 &lt;CompdrMt&gt;   238566 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 3 &lt;CompdrMt&gt;   238568 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 4 &lt;CompdrMt&gt;   238569 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 5 &lt;CompdrMt&gt;   238570 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 6 &lt;CompdrMt&gt;   238574 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 7 &lt;CompdrMt&gt;   238575 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 8 &lt;CompdrMt&gt;   238576 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
 9 &lt;CompdrMt&gt;   242965 Epipactis_atro… Epipactis atro… Darkred h… Plantae Magno…
10 &lt;CompdrMt&gt;   242966 Epipactis_atro… Epipactis atro… Darkred h… Plantae Magno…
# ℹ 41 more rows
# ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;,
#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, …</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="filtrar-para-la-familia-de-orquidaceae" class="level3">
<h3 class="anchored" data-anchor-id="filtrar-para-la-familia-de-orquidaceae">Filtrar para la familia de Orquidaceae</h3>
<ul>
<li>Extraer (filter) solamente las especies de la familia <strong>Orchidaceae</strong> de la base completa de datos de COMPADRE.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>index_O<span class="ot">=</span>TodasSp <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(Family <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Orchidaceae"</span>)) <span class="co"># Extraer la orquídeas de la base de datos. </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(index_O, <span class="at">n=</span><span class="dv">3</span>) <span class="co"># para visualizar las primera 3 filas de la base de datos de COMPADRE para las orquídeas.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 3 SPECIES and 3 MATRICES.

# A tibble: 3 × 59
  mat        MatrixID SpeciesAuthor    SpeciesAccepted CommonName Kingdom Phylum
  &lt;list&gt;        &lt;int&gt; &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
1 &lt;CompdrMt&gt;   238285 Caladenia_amonea Caladenia amon… &lt;NA&gt;       Plantae Trach…
2 &lt;CompdrMt&gt;   238286 Caladenia_argoc… Caladenia argo… &lt;NA&gt;       Plantae Trach…
3 &lt;CompdrMt&gt;   238287 Caladenia_clavi… Caladenia clav… &lt;NA&gt;       Plantae Trach…
# ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;,
#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;,
#   MatrixCriteriaSize &lt;chr&gt;, MatrixCriteriaOntogeny &lt;chr&gt;, …</code></pre>
</div>
</div>
<hr>
</section>
<section id="cual-son-los-géneros-de-la-familia-orchidaceae" class="level3">
<h3 class="anchored" data-anchor-id="cual-son-los-géneros-de-la-familia-orchidaceae">Cual son los géneros de la familia Orchidaceae</h3>
<ul>
<li>Cual son los géneros de la familia <strong>Orchidaceae</strong> incluidos en la base de datos de COMPADRE?</li>
<li>se usa la función <strong>unique()</strong> para seleccionar los géneros únicos en la base de datos.</li>
<li>se crea un data frame con los géneros únicos.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Genera<span class="ot">=</span>(<span class="fu">as.data.frame</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(index_O<span class="sc">$</span>Genus))))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(Genera)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sort(unique(index_O$Genus))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aspasia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brassavola</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Broughtonia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caladenia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cephalanthera</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cleistes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cleistesiopsis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corallorhiza</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cypripedium</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dactylorhiza</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dendrophylax</td>
</tr>
<tr class="even">
<td style="text-align: left;">Epipactis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Erycina</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guarianthe</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Herminium</td>
</tr>
<tr class="even">
<td style="text-align: left;">Himantoglossum</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jacquiniella</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lepanthes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lycaste</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neotinea</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oeceoclades</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oncidium</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ophrys</td>
</tr>
<tr class="even">
<td style="text-align: left;">Orchis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Platanthera</td>
</tr>
<tr class="even">
<td style="text-align: left;">Serapias</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spathoglottis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Telipogon</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tolumnia</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
</section>
<section id="lista-de-especies-únicas-de-orquídeas-en-la-base-de-datos-de-compadre." class="level3">
<h3 class="anchored" data-anchor-id="lista-de-especies-únicas-de-orquídeas-en-la-base-de-datos-de-compadre.">Lista de especies únicas de orquídeas en la base de datos de COMPADRE.</h3>
<ul>
<li>¿Cual son las especies únicas de la familia Orchidaceae incluidos en la base de datos de COMPADRE?</li>
<li>se usa la función <strong>unique()</strong> para seleccionar las especies únicas en la base de datos con la variable <em>SpeciesAccepted</em>.</li>
<li>se crea un data frame con las especies únicas.</li>
<li>Se arregla el data frame por orden alfabético.</li>
</ul>
<p>Note que al momento hay 46 especies con nombres únicos en la base de datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Especies_unicas<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(index_O<span class="sc">$</span>SpeciesAccepted)))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(Especies_unicas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sort(unique(index_O$SpeciesAccepted))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Aspasia principissa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brassavola cucullata</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Broughtonia cubensis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caladenia amonea</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caladenia argocalla</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caladenia clavigera</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caladenia elegans</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caladenia graniticola</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caladenia macroclavia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caladenia oenochila</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caladenia rosella</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caladenia valida</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cephalanthera longifolia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cleistes bifaria</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cleistesiopsis bifaria</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cleistesiopsis divaricata</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Corallorhiza trifida</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cypripedium calceolus</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cypripedium fasciculatum</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cypripedium lentiginosum</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cypripedium parviflorum</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dactylorhiza lapponica</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dendrophylax lindenii</td>
</tr>
<tr class="even">
<td style="text-align: left;">Epipactis atrorubens</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Erycina crista-galli</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guarianthe aurantiaca</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Herminium monorchis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Himantoglossum hircinum</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jacquiniella leucomelana</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jacquiniella teretifolia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lepanthes acuminata</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lepanthes caritensis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lepanthes eltoroensis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lepanthes rubripetala</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lepanthes rupestris</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lycaste aromatica</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neotinea ustulata</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oeceoclades maculata</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oncidium poikilostalix</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ophrys sphegodes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Orchis purpurea</td>
</tr>
<tr class="even">
<td style="text-align: left;">Platanthera hookeri</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Serapias cordigera</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spathoglottis plicata</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Telipogon helleri</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tolumnia variegata</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
</section>
</section>
<section id="contabilizar-cuantas-matrices-y-variables-estan-incluidas-en-el-archivo" class="level2">
<h2 class="anchored" data-anchor-id="contabilizar-cuantas-matrices-y-variables-estan-incluidas-en-el-archivo">Contabilizar cuantas matrices y variables estan incluidas en el archivo</h2>
<p>La base de datos de orquídea tiene un total de 647 filas con 59 variables, por consecuencia tiene 647 matrices. Esas matrices de la misma especie son de diferentes poblaciones, tiempo o un análisis teóricos. Nota que las 647 no son de diferentes especies, pero de especies que pueden haber sido muestreado en diferentes poblaciones o años.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(index_O)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 647  59</code></pre>
</div>
</div>
<hr>
<section id="la-fuente-de-la-información" class="level3">
<h3 class="anchored" data-anchor-id="la-fuente-de-la-información">La fuente de la información</h3>
<p>Para saber cuantos especies distintas y los manuscritos asociado a los estudios. En este caso los de esas 53 fuentes de información publicada, revisada por pares, tesis o informes técnicos. Algunas especies fueron estudiada y publicada en más de un manuscrito. Nota que las 9 primeras filas corresponde a 9 especies de <em>Caladenia</em> publicado en el mismo articulo. Se termina con 53 especies/publicaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>index_O <span class="sc">|&gt;</span> <span class="fu">select</span>(mat, SpeciesAccepted, DOI_ISBN) <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">paste0</span>(<span class="fu">pmax</span>(SpeciesAccepted, DOI_ISBN), <span class="fu">pmin</span>(SpeciesAccepted, DOI_ISBN))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 44 SPECIES and 53 MATRICES.

# A tibble: 53 × 3
   mat        SpeciesAccepted       DOI_ISBN                    
   &lt;list&gt;     &lt;chr&gt;                 &lt;chr&gt;                       
 1 &lt;CompdrMt&gt; Caladenia amonea      10.1071/BT08167             
 2 &lt;CompdrMt&gt; Caladenia argocalla   10.1071/BT08167             
 3 &lt;CompdrMt&gt; Caladenia clavigera   10.1071/BT08167             
 4 &lt;CompdrMt&gt; Caladenia elegans     10.1071/BT08167             
 5 &lt;CompdrMt&gt; Caladenia graniticola 10.1071/BT08167             
 6 &lt;CompdrMt&gt; Caladenia macroclavia 10.1071/BT08167             
 7 &lt;CompdrMt&gt; Caladenia oenochila   10.1071/BT08167             
 8 &lt;CompdrMt&gt; Caladenia rosella     10.1071/BT08167             
 9 &lt;CompdrMt&gt; Caladenia valida      10.1071/BT08167             
10 &lt;CompdrMt&gt; Epipactis atrorubens  10.1016/j.biocon.2017.04.019
# ℹ 43 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="frecuencia-de-autores-unicos-en-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="frecuencia-de-autores-unicos-en-la-base-de-datos">Frecuencia de autores unicos en la base de datos</h2>
<p>Igualmente podemos evaluar cuantos distintos autores son responsable de esas publicaciones. Un total de 37 grupos de autores únicos la fuente de esos artículos.</p>
</section>
<section id="roberto" class="level2">
<h2 class="anchored" data-anchor-id="roberto"><em>ROBERTO</em>:</h2>
<p>¿HAY una manera de contabilizar los nombres específicos (únicos), no por grupo? Para saber quien más publica sobre orquídeas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(index_O<span class="sc">$</span>Authors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Tremblay; Pérez; Larcombe; Brown; Quarmby; Bickerton; French; Bould"  
 [2] "Hens; Pakanen; Jäkäläniemi; Tuomi; Kvist"                             
 [3] "Schödelbauerová; Tremblay; Kindlmann"                                 
 [4] "Falcón; Ackerman; Tremblay"                                           
 [5] "Raventós; Gonzalez; Mújica; Bonet"                                    
 [6] "Shefferson; Kull; Tali; Kellett"                                      
 [7] "Gregg; Kéry"                                                          
 [8] "Mondragón; Maldonado; Aguilar-Santelises"                             
 [9] "Raventós; García-González; Riverón-Giró; Damon"                       
[10] "Crain; Tremblay; Ferguson"                                            
[11] "Tremblay"                                                             
[12] "Tremblay; Raventós; Ackerman; "                                       
[13] "García-González; Damon; Raventós; Riverón-Giró; Mújica; Solís-Montero"
[14] "Pellegrino; Bellusci"                                                 
[15] "Zotz; Schmidt"                                                        
[16] "Mondragón"                                                            
[17] "Winkler; Hülber; Hietz"                                               
[18] "Tremblay; Ackerman"                                                   
[19] "Calvo"                                                                
[20] "Wells; Willems"                                                       
[21] "Iriondo; Giménez-Benavides; Albert; Lozano; Escudero"                 
[22] "Nicolè; Brzosko; Till-Bottraud"                                       
[23] "García; Goñi; Guzman"                                                 
[24] "Thorpe; Stanley; Kayne; Latham"                                       
[25] "Zhongjian; Wenhui; Liqiang; Yuting"                                   
[26] "Shefferson; Warren II; Pulliam"                                       
[27] "Sletvold; Øien; Moen"                                                 
[28] "Sletvold; Dahlgren; Øien; Moen; Ehrlén"                               
[29] "Jäkäläniemi; Crone; Närhi; Tuomi"                                     
[30] "Wells; Rothery; Cox; Bamford"                                         
[31] "Pfeifer; Wiegand; Heinrich; Jetschke"                                 
[32] "Tremblay; McCarthy"                                                   
[33] "Shefferson; Tali"                                                     
[34] "Jacquemyns; Brys; Jongejans"                                          
[35] "Reddoch; Reddoch"                                                     
[36] "Riverón-Giró; Raventós; Damon; García-González; Mújica"               
[37] "Ackerman; Tremblay; Pérez; Madden; Bechtold; Boeken"                  </code></pre>
</div>
</div>
</section>
<section id="extraer-información-de-una-especie-específica" class="level2">
<h2 class="anchored" data-anchor-id="extraer-información-de-una-especie-específica">Extraer información de una especie específica</h2>
<p>En el siguiente script se enseña como extraer la información de una especie específica. En este caso se selecciona la especie <strong>Telipogon helleri</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Th<span class="ot">=</span>index_O <span class="sc">%&gt;%</span> <span class="fu">select</span>(SpeciesAccepted, mat, Authors, DOI_ISBN, MatrixDimension) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SpeciesAccepted <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Telipogon helleri"</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Th</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 1 SPECIES and 1 MATRICES.

# A tibble: 1 × 5
  SpeciesAccepted   mat        Authors                  DOI_ISBN MatrixDimension
  &lt;chr&gt;             &lt;list&gt;     &lt;chr&gt;                    &lt;chr&gt;              &lt;int&gt;
1 Telipogon helleri &lt;CompdrMt&gt; Raventós; García-Gonzál… 10.1080…               3</code></pre>
</div>
</div>
</section>
<section id="extraer-la-matriz" class="level2">
<h2 class="anchored" data-anchor-id="extraer-la-matriz">Extraer la matriz</h2>
<p>En el siguiente script se enseña la matrices de <strong>Telipogon helleri</strong> y las etapas de esta matrices. Nota que el objeto <strong>mat</strong> es una lista de matrices que incluye la matriz de transición (matU) de estados de una población, la matriz de fecundidad (matF), la matriz de clonaje (matC) y la suma de las tres matrices (matA=matU+MatF+matC) vea el capitulo de <a href="#MatricesTFC">Matrices de transición, fecundidad y clonal</a></p>
<p>La información incluye la clases/etapas que los autores usaron. El ciclo de vida incluyo 3 etapas, 1 inmaduras (S1-2) y 2 etapas de adultos (S3 y S4).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Th<span class="sc">$</span>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
  MatrixClassOrganized             MatrixClassAuthor
1               active             S1-2 (= Immature)
2               active S3 (= Adult; 0.01 - 6.00 cm2)
3               active       S4 (= Adult; ≥ 6.1 cm2)

matA:
       1      2      3
1 0.1548 0.1573 0.5309
2 0.2738 0.4425 0.1606
3 0.0238 0.4060 0.7368

matU:
       1      2      3
1 0.1548 0.0000 0.0000
2 0.2738 0.4425 0.1606
3 0.0238 0.4060 0.7368

matF:
  1      2      3
1 0 0.1573 0.5309
2 0 0.0000 0.0000
3 0 0.0000 0.0000

matC:
  1 2 3
1 0 0 0
2 0 0 0
3 0 0 0</code></pre>
</div>
</div>
</section>
<section id="cuantos-estudios-unicos" class="level2">
<h2 class="anchored" data-anchor-id="cuantos-estudios-unicos">Cuantos estudios unicos?</h2>
<p>Para evaluar el largo de tiempo por estudio se necesita seleccionar una combinación de variables única</p>
<p>NOTA: OrganismType es una variable que indica si la orquídea es un epifita o terrestre. <strong>Roberto MUCHOS están erroneos</strong>.<br>
- Todos las <em>Lepanthes</em> son epifitas, pero hay unas que son terrestres en la base de datos. - Todas las <em>Caladenia</em> son terrestres, pero hay unas que son epifitas en la base de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#names(index_O) Los nombres de las variables</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>SPECIES_O<span class="ot">=</span>index_O <span class="sc">%&gt;%</span> <span class="fu">select</span>(StudyStart, StudyEnd, SpeciesAccepted, YearPublication, Authors, DOI_ISBN, OrganismType, MatrixPopulation, mat) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SpeciesAccepted, YearPublication, OrganismType, StudyStart, StudyEnd) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_populations =</span> <span class="fu">length</span>(<span class="fu">unique</span>(MatrixPopulation))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(SpeciesAccepted) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StudyStart=</span><span class="fu">as.numeric</span>(StudyStart)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StudyEnd=</span><span class="fu">as.numeric</span>(StudyEnd)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(StudyStart, StudyEnd)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>SPECIES_O</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 6
# Groups:   SpeciesAccepted, YearPublication, OrganismType, StudyStart [54]
   SpeciesAccepted       YearPublication OrganismType StudyStart StudyEnd
   &lt;chr&gt;                 &lt;chr&gt;           &lt;chr&gt;             &lt;dbl&gt;    &lt;dbl&gt;
 1 Aspasia principissa   2006            Epiphyte           1997     2004
 2 Brassavola cucullata  2020            Epiphyte           2009     2014
 3 Broughtonia cubensis  2015            Epiphyte           2006     2010
 4 Caladenia amonea      2009            Epiphyte           1996     2007
 5 Caladenia argocalla   2009            Epiphyte           1996     2007
 6 Caladenia clavigera   2009            Epiphyte           1996     2007
 7 Caladenia elegans     2009            Epiphyte           1996     2007
 8 Caladenia graniticola 2009            Epiphyte           1996     2007
 9 Caladenia macroclavia 2009            Epiphyte           1996     2007
10 Caladenia oenochila   2009            Epiphyte           1996     2007
# ℹ 44 more rows
# ℹ 1 more variable: n_populations &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(SPECIES_O, "DATA/Species_O.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="determinar-cuantas-poblaciones-fueron-muestreadas-por-especies" class="level3">
<h3 class="anchored" data-anchor-id="determinar-cuantas-poblaciones-fueron-muestreadas-por-especies">Determinar cuantas poblaciones fueron muestreadas por especies</h3>
<ul>
<li>Cual es la frecuencia de cantidad de poblaciones por especies en la base de datos. La mayoría de los estudios usaron una sola población, pero hay estudios que usaron hasta 18 poblaciones distintas. Estas poblaciones pudiese ser de diferentes publicaciones o de las mismas poblaciones pero de diferentes fuentes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(<span class="fu">table</span>(SPECIES_O<span class="sc">$</span>n_populations))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Var1 Freq
1    1   27
2    2    7
3    3    4
4    4    6
5    6    4
6    7    3
7    8    2
8   18    1</code></pre>
</div>
</div>
</section>
<section id="cuan-largo-fueron-los-estudios" class="level3">
<h3 class="anchored" data-anchor-id="cuan-largo-fueron-los-estudios">¿Cuan largo fueron los estudios?</h3>
<p>Hay estudios que duraron pocos tiempos. El mínimo es de dos periodos de tiempo para calcular un periodo de transición. Hay otros estudios que muestrearon las poblaciones por mucho meas tiempo. Nota que tambien hay especies que fueron muestreados multiples veces pero a cada mes (los trabajos de Tremblay con <em>Lepanthes</em>) y otros a cada año.</p>
<ul>
<li>La duración de los estudios en la base de datos de COMPADRE. La mayoría de los estudios duraron pocos años.</li>
<li>Aquí vemos cuando comenzaron los estudios comenzaron y terminaron basado si las plantas son epifitas o no.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>SPECIES_O<span class="sc">$</span>SpeciesAccepted <span class="ot">&lt;-</span> <span class="fu">fct_reorder</span>(SPECIES_O<span class="sc">$</span>SpeciesAccepted, SPECIES_O<span class="sc">$</span>StudyStart, <span class="at">.desc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SPECIES_O, <span class="fu">aes</span>(SpeciesAccepted, <span class="at">color=</span>OrganismType))<span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">x=</span> SpeciesAccepted  , <span class="at">ymin=</span>StudyStart, <span class="at">ymax=</span>StudyEnd))<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))<span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  rlt_theme<span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">5</span>, <span class="at">face =</span> <span class="st">"plain"</span>),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"plain"</span>),  </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"plain"</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">5</span>, <span class="at">face =</span> <span class="st">"plain"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Lenght_survey.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<hr>
</section>
<section id="tiempo-de-duración-de-las-investigaciones." class="level3">
<h3 class="anchored" data-anchor-id="tiempo-de-duración-de-las-investigaciones.">Tiempo de duración de las investigaciones.</h3>
<ul>
<li>Figura de las duración de las investigaciones en la base de datos de COMPADRE. La mayoría de los estudios de orquídeas epifitas duraron pocos años al comparar con especies terrestres.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>index_O<span class="ot">=</span>index_O <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StudyDuration=</span><span class="fu">as.numeric</span>(StudyDuration))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#table(index_O$StudyDuration)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#table(index_O$OrganismType)</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(index_O, <span class="fu">aes</span>(StudyDuration, <span class="at">fill=</span>OrganismType))<span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="at">colour=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>OrganismType)<span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Study duration"</span>)<span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  rlt_theme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("Duración_Epi_Ter.pdf")</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Duración_Epi_Ter.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
</div>
</section>
<section id="evaluación-de-cumplimiento-de-condiciones" class="level3">
<h3 class="anchored" data-anchor-id="evaluación-de-cumplimiento-de-condiciones">Evaluación de cumplimiento de condiciones</h3>
<p>Para los análisis de PMP es necesario que la matrices cumple con ciertas condiciones. Dependiendo de la pregunta científica sea tiene que evaluar si esas matriz tienen las condiciones necesarias. Una de estas condiciones es la ergodicidad e irreducibilidad.</p>
<ul>
<li><p><strong>check_ergodic</strong>: Para la definición de ergodicidad vea Capitulo xx.</p></li>
<li><p><strong>check_irreducible</strong>: Para la definición de irreducibilidad vea Capitulo xx.</p></li>
<li><p><strong>check_NA_A</strong>: Determinar si hay valores faltantes en ‘matA’ Los valores faltantes (“NA”) en las matrices impiden que la mayoría de los cálculos utilicen esas matrices.</p></li>
<li><p><strong>check_NA_U</strong>: Determinar si hay valores faltantes en ‘matU’ Los valores faltantes (“NA”) en las matrices impiden que la mayoría de los cálculos utilicen esas matrices.</p></li>
<li><p><strong>check_NA_F</strong>: Determinar si hay valores faltantes en ‘matF’ Los valores faltantes (“NA”) en las matrices impiden que la mayoría de los cálculos utilicen esas matrices.</p></li>
<li><p><strong>check_NA_C</strong>: Determinar si hay valores faltantes en ‘matC’. Los valores faltantes (“NA”) en las matrices impiden que la mayoría de los cálculos utilicen esas matrices.</p></li>
<li><p><strong>check_zero_U</strong>: Determinar si la ‘matU’ tiene todos ceros (incluido ‘NA’). Las submatrices compuestas enteramente de valores cero pueden resultar problemáticas. Puede haber buenas razones biológicas para este fenómeno. Por ejemplo, en la población focal particular en el año focal particular, realmente no se registró una supervivencia. Sin embargo, las submatrices de valor cero pueden provocar que algunos cálculos fallen y puede ser necesario excluirlas.</p></li>
<li><p><strong>check_zero_F</strong>: Determinar si la ‘matF’ tiene todos ceros (incluido ‘NA’). Las submatrices compuestas enteramente de valores cero pueden resultar problemáticas. Puede haber buenas razones biológicas para este fenómeno o de preguntas científicas. Por ejemplo, en la población particular en el año particular, realmente no se registró reproducción. Sin embargo, las submatrices con valores de cero pueden provocar que algunos cálculos fallen y puede ser necesario excluirlas. En otros estudios no se evaluó la fecundidad ya que estos parámetros no eran necesaria para contestar las preguntas científicas.</p></li>
<li><p><strong>check_zero_U_colsum</strong>: Determinar si las columnas de ‘matU’ suman a cero, esto implica que no hay supervivencia de esa etapa en particular. Esta puede ser una parametrización perfectamente válida para un año/lugar en particular, pero es biológicamente irrazonable a largo plazo y los usuarios pueden desear excluir matrices problemáticas de su análisis.</p></li>
<li><p><strong>check_singular_U</strong>: Determinar si ‘matU’ es singular. Se dice que las matrices son singulares si no se pueden invertir. Se requiere inversión para muchos cálculos matriciales y, por lo tanto, la singularidad puede hacer que algunos cálculos fallen.</p></li>
<li><p><strong>check_component_sum</strong>: Determinar si las submatrices ‘matU’/‘matF’/‘matC’ suman a ‘matA’. Un MPM completo (“matA”) se puede dividir en las submatrices que lo componen (es decir, “matU”, “matF” y “matC”). La suma de estas submatrices debe ser igual al MPM completo (es decir, ‘matA’ = ‘matU’ + ‘matF’ + ‘matC’). A veces, sin embargo, se producen errores de modo que las submatrices NO suman ‘matA’. Normalmente, esto se debe a errores de redondeo, pero es posible que se produzcan errores más importantes.</p></li>
<li><p><strong>check_ergodic</strong>: Determinar si ‘matA’ es ergódico (ver isErgodic). Algunos cálculos matriciales requieren que el MPM (“matA”) sea ergódico. Los MPM ergódicos son aquellos en los que existe un único estado estable asintótico que no depende de la estructura de la etapa inicial. Por el contrario, los MPM no ergódicos son aquellos en los que existen múltiples estados estables asintóticos, que dependen de la estructura de la etapa inicial. Los MPM que no son ergódicos suelen ser biológicamente irrazonables, tanto en términos de la descripción de su ciclo de vida como de su dinámica proyectada. Hacen que algunos cálculos fallen.</p></li>
<li><p><strong>check_irreducible</strong>: Determinar si ‘matA’ es irreducible (ver isIrreducible). Algunos cálculos matriciales requieren que el MPM (“matA”) sea irreducible. Los MPM irreducibles son aquellos en los que las tasas de transición parametrizadas facilitan el paso de todas las etapas a todas las demás etapas. Por el contrario, los MPM reducibles representan ciclos de vida incompletos donde no son posibles caminos desde todas las etapas a todas las demás etapas. Los MPM que son reducibles suelen ser biológicamente irrazonables (pero no siempre), tanto en términos de la descripción de su ciclo de vida como de su dinámica proyectada. Hacen que algunos cálculos fallen. La irreductibilidad es necesaria pero no suficiente para la ergodicidad.</p></li>
<li><p><strong>check_primitive</strong>: Detemrminar si ‘matA’ es primitivo (ver isPrimitive). Una matriz primitiva es una matriz no negativa que es irreducible y tiene un solo valor propio de módulo máximo. Por lo tanto, esta verificación es redundante debido a la superposición con ‘check_irreducible’ y ‘checkErdogic’.</p></li>
<li><p><strong>check_surv_gte_1</strong>: Determinar si ‘matU’ contiene valores iguales o mayores que 1. La supervivencia está limitada entre 0 y 1. Los valores superiores a 1 no son biológicamente razonables (vea capitulo Impacto de Datos sin sentidos).</p></li>
</ul>
<p>Usando la función cdb_flag se puede evaluar todas las opciones en la base de datos de COMPADRE.</p>
<p>Usando la función <strong>cdb_flag</strong> se identifica problemas potenciales en las matrices de transición de estados de las poblaciones. Esa función añade una fila por opciones en la matriz. Nota que para cada prueba anterior crea una columna con <strong>TRUE</strong> o <strong>FALSE</strong> para cada matriz en la base de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Orchids_New=as_cdb(index)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#compadre$mat[index]</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Compadre_flagged <span class="ot">&lt;-</span> <span class="fu">cdb_flag</span>(index_O) <span class="co"># Evaluación de todas las opciones en la base de datos de COMPADRE</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>Compadre_flagged <span class="sc">%&gt;%</span> <span class="fu">select</span>(mat, SpeciesAccepted, <span class="fu">starts_with</span>(<span class="st">"check"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 46 SPECIES and 647 MATRICES.

# A tibble: 647 × 16
   mat        SpeciesAccepted       check_NA_A check_NA_U check_NA_F check_NA_C
   &lt;list&gt;     &lt;chr&gt;                 &lt;lgl&gt;      &lt;lgl&gt;      &lt;lgl&gt;      &lt;lgl&gt;     
 1 &lt;CompdrMt&gt; Caladenia amonea      FALSE      FALSE      FALSE      FALSE     
 2 &lt;CompdrMt&gt; Caladenia argocalla   FALSE      FALSE      FALSE      FALSE     
 3 &lt;CompdrMt&gt; Caladenia clavigera   FALSE      FALSE      FALSE      FALSE     
 4 &lt;CompdrMt&gt; Caladenia elegans     FALSE      FALSE      FALSE      FALSE     
 5 &lt;CompdrMt&gt; Caladenia graniticola FALSE      FALSE      FALSE      FALSE     
 6 &lt;CompdrMt&gt; Caladenia macroclavia FALSE      FALSE      FALSE      FALSE     
 7 &lt;CompdrMt&gt; Caladenia oenochila   FALSE      FALSE      FALSE      FALSE     
 8 &lt;CompdrMt&gt; Caladenia rosella     FALSE      FALSE      FALSE      FALSE     
 9 &lt;CompdrMt&gt; Caladenia valida      FALSE      FALSE      FALSE      FALSE     
10 &lt;CompdrMt&gt; Epipactis atrorubens  FALSE      FALSE      FALSE      FALSE     
# ℹ 637 more rows
# ℹ 10 more variables: check_zero_U &lt;lgl&gt;, check_zero_F &lt;lgl&gt;,
#   check_zero_C &lt;lgl&gt;, check_zero_U_colsum &lt;lgl&gt;, check_singular_U &lt;lgl&gt;,
#   check_component_sum &lt;lgl&gt;, check_ergodic &lt;lgl&gt;, check_irreducible &lt;lgl&gt;,
#   check_primitive &lt;lgl&gt;, check_surv_gte_1 &lt;lgl&gt;</code></pre>
</div>
</div>
<section id="ergodicidad-e-irreducibilidad" class="level4">
<h4 class="anchored" data-anchor-id="ergodicidad-e-irreducibilidad">Ergodicidad e Irreducibilidad</h4>
<p>En los siguientes scripts se filtra para las matrices con ciertas condiciones para evaluar si las matrices son ergódicas e irreducibles. Notas las matrices que son ergódica son irreducibles, pero no todas las matrices irreducibles son ergódicas. Evalué la cantidad de filas en cada caso.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Mat_ergodic <span class="ot">&lt;-</span> <span class="fu">subset</span>(Compadre_flagged, check_NA_A <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> check_ergodic <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="co"># para evaluar si las matrices son ergódicas</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Mat_ergodic </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 45 SPECIES and 484 MATRICES.

# A tibble: 484 × 73
   mat        MatrixID SpeciesAuthor   SpeciesAccepted CommonName Kingdom Phylum
   &lt;list&gt;        &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
 1 &lt;CompdrMt&gt;   238285 Caladenia_amon… Caladenia amon… &lt;NA&gt;       Plantae Trach…
 2 &lt;CompdrMt&gt;   238286 Caladenia_argo… Caladenia argo… &lt;NA&gt;       Plantae Trach…
 3 &lt;CompdrMt&gt;   238287 Caladenia_clav… Caladenia clav… &lt;NA&gt;       Plantae Trach…
 4 &lt;CompdrMt&gt;   238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt;       Plantae Trach…
 5 &lt;CompdrMt&gt;   238289 Caladenia_gran… Caladenia gran… &lt;NA&gt;       Plantae Trach…
 6 &lt;CompdrMt&gt;   238290 Caladenia_macr… Caladenia macr… &lt;NA&gt;       Plantae Trach…
 7 &lt;CompdrMt&gt;   238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt;       Plantae Trach…
 8 &lt;CompdrMt&gt;   238292 Caladenia_rose… Caladenia rose… &lt;NA&gt;       Plantae Trach…
 9 &lt;CompdrMt&gt;   238293 Caladenia_vali… Caladenia vali… &lt;NA&gt;       Plantae Trach…
10 &lt;CompdrMt&gt;   238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
# ℹ 474 more rows
# ℹ 66 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;,
#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Mat_irred <span class="ot">&lt;-</span> <span class="fu">subset</span>(Compadre_flagged, check_NA_A <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> check_irreducible <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="co"># para evaluar si las matrices son irreducibles</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Mat_irred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 43 SPECIES and 360 MATRICES.

# A tibble: 360 × 73
   mat        MatrixID SpeciesAuthor   SpeciesAccepted CommonName Kingdom Phylum
   &lt;list&gt;        &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
 1 &lt;CompdrMt&gt;   238285 Caladenia_amon… Caladenia amon… &lt;NA&gt;       Plantae Trach…
 2 &lt;CompdrMt&gt;   238286 Caladenia_argo… Caladenia argo… &lt;NA&gt;       Plantae Trach…
 3 &lt;CompdrMt&gt;   238287 Caladenia_clav… Caladenia clav… &lt;NA&gt;       Plantae Trach…
 4 &lt;CompdrMt&gt;   238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt;       Plantae Trach…
 5 &lt;CompdrMt&gt;   238289 Caladenia_gran… Caladenia gran… &lt;NA&gt;       Plantae Trach…
 6 &lt;CompdrMt&gt;   238290 Caladenia_macr… Caladenia macr… &lt;NA&gt;       Plantae Trach…
 7 &lt;CompdrMt&gt;   238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt;       Plantae Trach…
 8 &lt;CompdrMt&gt;   238292 Caladenia_rose… Caladenia rose… &lt;NA&gt;       Plantae Trach…
 9 &lt;CompdrMt&gt;   238293 Caladenia_vali… Caladenia vali… &lt;NA&gt;       Plantae Trach…
10 &lt;CompdrMt&gt;   238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
# ℹ 350 more rows
# ℹ 66 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;,
#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Mat_erg_irred <span class="ot">&lt;-</span> <span class="fu">subset</span>(Compadre_flagged, check_NA_A <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> check_irreducible <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> check_ergodic <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="co"># para evaluar si las matrices son ergódicas e irreducibles al mismo tiempo</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Mat_erg_irred </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 43 SPECIES and 360 MATRICES.

# A tibble: 360 × 73
   mat        MatrixID SpeciesAuthor   SpeciesAccepted CommonName Kingdom Phylum
   &lt;list&gt;        &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
 1 &lt;CompdrMt&gt;   238285 Caladenia_amon… Caladenia amon… &lt;NA&gt;       Plantae Trach…
 2 &lt;CompdrMt&gt;   238286 Caladenia_argo… Caladenia argo… &lt;NA&gt;       Plantae Trach…
 3 &lt;CompdrMt&gt;   238287 Caladenia_clav… Caladenia clav… &lt;NA&gt;       Plantae Trach…
 4 &lt;CompdrMt&gt;   238288 Caladenia_eleg… Caladenia eleg… &lt;NA&gt;       Plantae Trach…
 5 &lt;CompdrMt&gt;   238289 Caladenia_gran… Caladenia gran… &lt;NA&gt;       Plantae Trach…
 6 &lt;CompdrMt&gt;   238290 Caladenia_macr… Caladenia macr… &lt;NA&gt;       Plantae Trach…
 7 &lt;CompdrMt&gt;   238291 Caladenia_oeno… Caladenia oeno… &lt;NA&gt;       Plantae Trach…
 8 &lt;CompdrMt&gt;   238292 Caladenia_rose… Caladenia rose… &lt;NA&gt;       Plantae Trach…
 9 &lt;CompdrMt&gt;   238293 Caladenia_vali… Caladenia vali… &lt;NA&gt;       Plantae Trach…
10 &lt;CompdrMt&gt;   238565 Epipactis_atro… Epipactis atro… Darkred h… Plantae Trach…
# ℹ 350 more rows
# ℹ 66 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;,
#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
</section>
<section id="ahora-usando-las-matrices-que-cumple-con-las-condiciones-de-ergodicidad-y-irreducbilidad-se-puede-calcular-el-valor-propio-de-lambda." class="level3">
<h3 class="anchored" data-anchor-id="ahora-usando-las-matrices-que-cumple-con-las-condiciones-de-ergodicidad-y-irreducbilidad-se-puede-calcular-el-valor-propio-de-lambda.">Ahora usando las matrices que cumple con las condiciones de ergodicidad y irreducbilidad se puede calcular el valor propio de lambda.</h3>
<ul>
<li><p>La función <strong>eigs</strong> calcula los valores propios de una matriz, la función proviene de la library(popdemo). En este caso se calcula el valor propio de lambda para las matrices que son ergódicas e irreducibles previamente seleccionado. Usando la función <strong>sapply</strong> se aplica la función <strong>eigs</strong> a todas las matrices en la base de datos y crea una lista de los cálculos. Si mira la lista de valores propios de lambda en el objeto <strong>lambdaVals</strong> se observa valor por cada <strong>matA</strong> incluido en el archivo.</p></li>
<li><p>Se usa la función <strong>summary</strong> para resumir los valores propios de lambda.</p></li>
<li><p>Se usa la función <strong>hist</strong> para visualizar la distribución de los valores propios de lambda.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>lambdaVals <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">matA</span>(Mat_erg_irred), popdemo<span class="sc">::</span>eigs, <span class="at">what=</span><span class="st">"lambda"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lambdaVals) <span class="co"># la distribuciones de los lambdas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3888  0.9407  0.9993  0.9891  1.0313  1.7760 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lambdaVals, <span class="at">main =</span> <span class="st">"Lambda values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Una segunda alternativa es usar la función <strong>map_dbl</strong> de la librería <strong>purrr</strong> para calcular cada uno los valores propios de lambda.</p>
<ul>
<li>Las función de <strong>map_dbl</strong> transforman su entrada aplicando una función a cada elemento de una lista y devolviendo un objeto de la misma longitud que la entrada. En este caso por cada <strong>matA</strong>, habrá un lambda.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="do">## con el paquete popdemo</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>lambdaVals1 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="fu">matA</span>(Mat_erg_irred), <span class="sc">~</span>popdemo<span class="sc">::</span><span class="fu">eigs</span>(.x, <span class="at">what=</span><span class="st">"lambda"</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="do">##O con el paquete popbio, que evita algunos mensajes de advertencia</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>lambdaVals2 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="fu">matA</span>(Mat_erg_irred), <span class="sc">~</span>popbio<span class="sc">::</span><span class="fu">lambda</span>(.x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cambiar-el-estado-de-algunas-variables" class="level3">
<h3 class="anchored" data-anchor-id="cambiar-el-estado-de-algunas-variables">Cambiar el estado de algunas variables</h3>
</section>
<section id="se-cambia-todas-las-caladenia-de-epifitas-a-terrestres" class="level3">
<h3 class="anchored" data-anchor-id="se-cambia-todas-las-caladenia-de-epifitas-a-terrestres">Se cambia todas las <em>Caladenia</em> de epifitas a terrestres</h3>
</section>
</section>
<section id="resolve-the-name-of-this-data-frame-give-it-a-more-reasonable-name" class="level2">
<h2 class="anchored" data-anchor-id="resolve-the-name-of-this-data-frame-give-it-a-more-reasonable-name">Resolve the name of this data frame… Give it a more reasonable name</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>New_Data<span class="ot">=</span>Mat_erg_irred <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OrganismType =</span> <span class="fu">case_when</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    Genus <span class="sc">==</span>  <span class="st">"Caladenia"</span> <span class="sc">&amp;</span> OrganismType <span class="sc">==</span> <span class="st">"Epiphyte"</span> <span class="sc">~</span> <span class="st">"Herbaceous perennial"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> OrganismType</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>epifitas<span class="ot">=</span>New_Data <span class="sc">%&gt;%</span> </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OrganismType<span class="sc">==</span><span class="st">"Epiphyte"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>terrestres<span class="ot">=</span>New_Data <span class="sc">%&gt;%</span> </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OrganismType<span class="sc">==</span><span class="st">"Herbaceous perennial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variación-en-crecimiento-de-la-popblación-en-epifitas" class="level2">
<h2 class="anchored" data-anchor-id="variación-en-crecimiento-de-la-popblación-en-epifitas">Variación en crecimiento de la popblación en <em>Epifitas</em></h2>
<p>Aqui seleccionamos las especies de <em>Epifitas</em> con todas las poblaciones muestradas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Compadre_flagged_epif <span class="ot">&lt;-</span> <span class="fu">cdb_flag</span>(epifitas)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>x_epif <span class="ot">&lt;-</span> <span class="fu">subset</span>(Compadre_flagged_epif, check_NA_A <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> check_ergodic <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#sapply(matA(x_epi), popdemo::eigs, what="lambda")</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>lambda_epif <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="fu">matA</span>(x_epif), <span class="sc">~</span>popdemo<span class="sc">::</span><span class="fu">eigs</span>(.x, <span class="at">what=</span><span class="st">"lambda"</span>))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Or with popbio, which avoids some warning messages…</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>lambda_terr <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="fu">matA</span>(terrestres), <span class="sc">~</span>popbio<span class="sc">::</span><span class="fu">lambda</span>(.x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con la función evaluando las especies terrestres y epifitas uno observa que las especies terrestres tienen valores propios de lambda más dispersos que las especies epifitas, y aunque los promedios son distintos la mediana es similar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lambda_epif)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3888  0.9715  1.0003  0.9716  1.0124  1.3592 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lambda_epif, <span class="at">main =</span> <span class="st">"Lambda values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lambda_terr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4089  0.9329  0.9988  0.9973  1.0516  1.7760 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lambda_terr, <span class="at">main =</span> <span class="st">"Lambda values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Para visualizar loa datos en una figura de <strong>ggplot2</strong>, hay que convertir estas filas en un data.frame y añadir una columna con el tipo de habitad, renombrar la columna lambda y unir los dos data.frames en uno solo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df_Lamb_epif<span class="ot">=</span><span class="fu">as.data.frame</span>(lambda_epif)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df_Lamb_epi<span class="ot">=</span>df_Lamb_epif <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Habit_Type =</span> <span class="st">"Epífitas"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lambda=</span>lambda_epif)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>df_Lamb_terr<span class="ot">=</span><span class="fu">as.data.frame</span>(lambda_terr)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>df_Lamb_terr<span class="ot">=</span>df_Lamb_terr <span class="sc">%&gt;%</span> </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">Habit_Type =</span> <span class="st">"Terrestre"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lambda=</span>lambda_terr)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>ALL_Lambdas<span class="ot">=</span><span class="fu">rbind</span>(df_Lamb_epi, df_Lamb_terr) <span class="co"># unir los dos data frame en uno</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ALL_Lambdas, <span class="fu">aes</span>(lambda, <span class="at">fill=</span>Habit_Type ))<span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour=</span><span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span>Habit_Type)<span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  rlt_theme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Terr_Epi_lambda.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
</div>
<p>Para calcular los coeficientes (el promedio) y determinar si estos son significativamente diferentes entre los grupos se puede usar un modelo lineal y la función <strong>lm</strong>. En este caso se usa la variable <strong>Habit_Type</strong> para predecir el valor propio de lambda. Añadiendo un <strong>-1</strong> al modelo hace que los coeficientes para cada grupo este en la tabla de salida y no hay que hacer un calculo suplementario. Note que lo más interesante de este análisis es que las especies terrestres tienen menos dispersión cuando evaluado con el error estándar que las especies epifitas, y aunque los cuartiles son más amplios (análisis anterior).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>model_lambda<span class="ot">=</span><span class="fu">lm</span>(lambda <span class="sc">~</span> Habit_Type<span class="dv">-1</span>, <span class="at">data=</span>ALL_Lambdas)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lambda ~ Habit_Type - 1, data = ALL_Lambdas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.58838 -0.04452  0.01335  0.04734  0.77877 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
Habit_TypeEpífitas  0.971600   0.013069   74.34   &lt;2e-16 ***
Habit_TypeTerrestre 0.997261   0.008897  112.10   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1395 on 358 degrees of freedom
Multiple R-squared:  0.9806,    Adjusted R-squared:  0.9805 
F-statistic:  9046 on 2 and 358 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># paquete para hacer tablas de modelos</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_lambda) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                estimate std.error statistic   p.value
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 Habit_TypeEpífitas     0.972   0.0131       74.3 9.92e-220
2 Habit_TypeTerrestre    0.997   0.00890     112.  6.91e-281</code></pre>
</div>
</div>
<p>Uno puedo visualizar estas distribuciones usando la librería <strong>ggdist</strong> y <strong>distributional</strong>, con la función <strong>stat_halfeye</strong>. Es importante notar que la función <strong>stat_halfeye</strong> requiere que se especifique la distribución de los datos y que la información proviene del modelo anterior (model_lambda). En este análisis se asume que los <span class="math inline">\(\lambda\)</span> tienen una distribución normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(distributional)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>model_lambda <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> term)) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(model_lambda), <span class="at">mu =</span> estimate, <span class="at">sigma =</span> std.error))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La gráfica anterior puede esconder la dispersión de los datos, específicamente los datos sesgados, por lo que se puede añadir los datos originales a la figura. En el siguiente caso se añade un <strong>|</strong> por cada lambda en la posición inferior de la figura. Nota ahora que la dispersión de los datos es varia si uno mira la distribución con el promedio y el error estandard versus los datos originales, los <strong>|</strong>. es claro que con esta figura uno puede apreciar la dispersión de los datos y la distribución de los datos. Esta gráfica da muy diferente al anterior con una perspectiva más completa de los datos, enfocado a en los datos fuera de datos centrado de la distribución.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>ALL_Lambdas <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(Habit_Type) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(model_lambda, <span class="at">newdata =</span> ., <span class="at">se_fit =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Habit_Type, <span class="at">colour=</span>Habit_Type)) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">xdist =</span> <span class="fu">dist_student_t</span>(<span class="at">df =</span> <span class="fu">df.residual</span>(model_lambda), <span class="at">mu =</span> .fitted, <span class="at">sigma =</span> .se.fit)),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> .<span class="dv">5</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda), <span class="at">data =</span> ALL_Lambdas, <span class="at">pch =</span> <span class="st">"|"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="sc">-</span>.<span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="la-cantidad-de-poblaciones-por-especies-en-la-base-de-datos-de-compadre." class="level3">
<h3 class="anchored" data-anchor-id="la-cantidad-de-poblaciones-por-especies-en-la-base-de-datos-de-compadre.">La cantidad de poblaciones por especies en la base de datos de COMPADRE.</h3>
<ul>
<li>La cantidad de poblaciones por especies en la base de datos de COMPADRE varia grandemente. La mayoría de las especies tienen una sola población, pero hay especies que tienen hasta 20 poblaciones distintas. Estas poblaciones pudiese ser de diferentes publicaciones. Por ejemplo los datos de <em>Lepanthes rupestris</em> provienen de dos publicaciones distintas <span class="citation" data-cites="tremblay2001gene tremblay2014bayesian">(<a href="#ref-tremblay2001gene" role="doc-biblioref">R. Tremblay and Ackerman 2001</a>; <a href="#ref-tremblay2014bayesian" role="doc-biblioref">R. L. Tremblay and McCarthy 2014</a>)</span>, hasta pudiese en parte ser matrices recolectado de la misma población en los años, pero con objetivos distintos. En la primera publicación <span class="citation" data-cites="tremblay2001gene">(<a href="#ref-tremblay2001gene" role="doc-biblioref">R. Tremblay and Ackerman 2001</a>)</span> se uso para evaluar el tamaño efectivo de la poblaciones, <strong>Ne</strong>. En la segunda publicación <span class="citation" data-cites="tremblay2014bayesian">(<a href="#ref-tremblay2014bayesian" role="doc-biblioref">R. L. Tremblay and McCarthy 2014</a>)</span> se uso para lo datos de las misma poblaciones anterior y periodo de tiempo para evaluar un nuevo método para calcular los elementos de la matriz cuando hay pocos datos en cada población o tiempo y se aprovecha del conocimiento de la información para tener estimados de los parámetros más biologícamente realista.</li>
</ul>
<hr>
<p>Creación de un mapa de distribución de las especies en COMPADRE.</p>
<p>La lista presente corresponde a los datos de COMPADRE y suplementada con busqueda en los articulos para crear un mapa donde fueron hecho los estudios de dinamica poblacional.</p>
<p>Lista de números de poblaciones únicas por especies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>Orchid_data_DOI_Diana_3a <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/Orchid_data_DOI_Diana_3a.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>Lat_Long<span class="ot">=</span>Orchid_data_DOI_Diana_3a <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SpeciesAccepted, Lon, Lat, OrganismType) <span class="sc">|&gt;</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(SpeciesAccepted, Lon, Lat, OrganismType)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(Lat_Long, "data/Orchid_data_DOI_Diana_3a.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Usamos el paquete ggplot2 para visualizar la distribución de las orquídeas en la base de datos de COMPADRE. En este caso se usa la función <strong>borders</strong> para añadir los bordes de los países al mapa. La función <strong>borders</strong> usa funciones en el paquete <strong>maps</strong> para añadir los bordes de los países al mapa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(Lat_Long, <span class="fu">aes</span>(Lon, Lat,<span class="at">colour=</span>OrganismType)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">borders</span>(<span class="at">database =</span> <span class="st">"world"</span>, <span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">col =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("orchid_map.jpg")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="usando-leaflet-para-mapar-de-distribución-interactivo" class="level2">
<h2 class="anchored" data-anchor-id="usando-leaflet-para-mapar-de-distribución-interactivo">Usando leaflet para mapar de distribución interactivo</h2>
<p>Aquí se usa el paquete <strong>Leaflet</strong> para mapear los sitios de muestreo de las especies donde hubo trabajo de campo, usando técnicas de marca-recaptura y análisis de dinámica poblacional.</p>
<p>Se observa una disparidad en la cantidad de sitios de muestreo entre las especies, con algunas especies con muchos sitios de muestreo y otras con pocos. Las poblaciones en azul son plantas epifitas y las rojas son orquídeas terrestres. Note la disparidad, las especies terrestres estan mayormente en Europa y Norte América, con poca representación en Asia y ninguna en Africa. La especies epifitas están todas en el Caribe y Centro América (México) y ninguna en Africa, Asia y Australia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>PointUsePalette <span class="ot">&lt;-</span> leaflet<span class="sc">::</span><span class="fu">colorFactor</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">domain =</span> <span class="fu">c</span>(<span class="st">"Epiphyte"</span>, <span class="st">"Herbaceous perennial"</span>)) <span class="co"># para asignar los colores a los factores (clase de Vida)</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>Orchid_map<span class="ot">=</span><span class="fu">leaflet</span>(Lat_Long) <span class="sc">%&gt;%</span> <span class="co"># los datos</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> <span class="sc">~</span>Lon, <span class="co"># la longitud</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">lat =</span> <span class="sc">~</span>Lat, <span class="co"># la latitud</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">radius =</span> <span class="dv">2</span>, <span class="co"># el tamaño del punto</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span> <span class="sc">~</span><span class="fu">PointUsePalette</span>(OrganismType), <span class="co"># Para colorear los puntos por el tipo clase de vida</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">popup=</span> <span class="sc">~</span><span class="fu">paste0</span>( <span class="st">"&lt;I&gt;"</span>, SpeciesAccepted, <span class="st">"&lt;/I&gt;"</span>) <span class="co"># para poner los nombres cientificos en italicos</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>Orchid_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-2a62a249efe93b438495" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2a62a249efe93b438495">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[9.166667,17.621111,17.5,17.48,22,-37.105,-34.32,-37.76,-28.35,-33.05,-34.5,-37.17,-37.6716,-37,58.472222,58.559722,58.9094,59.491111,29.658701,39.279202,29.65,39.279167,34.083333,42.633333,42.659444,42.769722,53.266667,58.625,58.579444,58.625,59.483333,42.333333,42.2,42.25,42.333333,23.116667,42.3833,63.05,63.05,62.6667,62.666667,21.5,66.37417000000001,66.389444,66.367222,66.36666700000001,66.366389,66.37472200000001,66.366944,66.36750000000001,66.37388900000001,14.983333,15.03,15.064444,51.883333,50.946111,19.5,19,15.091944,18.101667,18.094167,18.3,18.0941,18.2956,18.294722,18.295,18.4,18.319167,18.321389,18.316667,18.35,20,58.5561,58.556111,58.628333,58.646389,58.614722,59.255278,15.566056,14.894806,14.989194,14.794667,15.091944,50.844444,50.75,45.483333,39.265556,39.221944,39.363333,39.343056,39.346944,39.856667,18.349444,15.091944,18.451389],[-79.84999999999999,-63.226111,-62.99,-62.959,-84.515278,145.39,138.57,142.96,114.63,119.01,137.6,143.43,146.1772,147.43,21.917222,23.552222,24.7383,25.639444,-82.277496,-79.9328,-82.283333,-79.932778,-78.3,0.083333,0.120278,0.357778,22.65,23.25,23.266389,23.27,26.341667,-123.516667,-123.5,-123.166667,-122.45,104.633333,-88.08,9.083299999999999,9.083333,11.8333,11.833333,-84.515278,29.21667,29.267778,29.313889,29.316667,29.3175,29.319444,29.322778,29.327222,29.336944,-92.166667,-92.105833,-92.08111100000001,0.583333,11.593056,-96.95,-96.95,-92.16583300000001,-66.072778,-66.0275,-65.783333,-66.0797,-65.8023,-65.8,-65.8,-65.783333,-65.825,-65.819722,-65.816667,-65.816667,-96.95,23.1811,23.181111,23.207222,23.320278,23.568056,25.722778,-92.83408300000001,-92.306389,-92.285139,-92.185778,-92.16583300000001,-0.050833,5.75,-75.84999999999999,16.098611,16.115833,16.230833,16.232778,16.233611,16.366111,-66.684444,-92.16583300000001,-66.59944400000001],2,null,null,{"interactive":true,"className":"","stroke":true,"color":["#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#0000FF","#0000FF","#FF0000","#FF0000","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#0000FF"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#0000FF","#0000FF","#FF0000","#FF0000","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#FF0000","#0000FF","#0000FF"],"fillOpacity":0.2},null,null,["<I>Aspasia principissa<\/I>","<I>Brassavola cucullata<\/I>","<I>Brassavola cucullata<\/I>","<I>Brassavola cucullata<\/I>","<I>Broughtonia cubensis<\/I>","<I>Caladenia amonea<\/I>","<I>Caladenia argocalla<\/I>","<I>Caladenia clavigera<\/I>","<I>Caladenia elegans<\/I>","<I>Caladenia graniticola<\/I>","<I>Caladenia macroclavia<\/I>","<I>Caladenia oenochila<\/I>","<I>Caladenia rosella<\/I>","<I>Caladenia valida<\/I>","<I>Cephalanthera longifolia<\/I>","<I>Cephalanthera longifolia<\/I>","<I>Cephalanthera longifolia<\/I>","<I>Cephalanthera longifolia<\/I>","<I>Cleistes bifaria<\/I>","<I>Cleistes bifaria<\/I>","<I>Cleistesiopsis bifaria<\/I>","<I>Cleistesiopsis bifaria<\/I>","<I>Cleistesiopsis divaricata<\/I>","<I>Corallorhiza trifida<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium calceolus<\/I>","<I>Cypripedium fasciculatum<\/I>","<I>Cypripedium fasciculatum<\/I>","<I>Cypripedium fasciculatum<\/I>","<I>Cypripedium fasciculatum<\/I>","<I>Cypripedium lentiginosum<\/I>","<I>Cypripedium parviflorum<\/I>","<I>Dactylorhiza lapponica<\/I>","<I>Dactylorhiza lapponica<\/I>","<I>Dactylorhiza lapponica<\/I>","<I>Dactylorhiza lapponica<\/I>","<I>Dendrophylax lindenii<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Epipactis atrorubens<\/I>","<I>Erycina crista-galli<\/I>","<I>Erycina crista-galli<\/I>","<I>Guarianthe aurantiaca<\/I>","<I>Herminium monorchis<\/I>","<I>Himantoglossum hircinum<\/I>","<I>Jacquiniella leucomelana<\/I>","<I>Jacquiniella teretifolia<\/I>","<I>Lepanthes acuminata<\/I>","<I>Lepanthes caritensis<\/I>","<I>Lepanthes caritensis<\/I>","<I>Lepanthes eltoroensis<\/I>","<I>Lepanthes rubripetala<\/I>","<I>Lepanthes rubripetala<\/I>","<I>Lepanthes rubripetala<\/I>","<I>Lepanthes rubripetala<\/I>","<I>Lepanthes rubripetala<\/I>","<I>Lepanthes rupestris<\/I>","<I>Lepanthes rupestris<\/I>","<I>Lepanthes rupestris<\/I>","<I>Lepanthes rupestris<\/I>","<I>Lycaste aromatica<\/I>","<I>Neotinea ustulata<\/I>","<I>Neotinea ustulata<\/I>","<I>Neotinea ustulata<\/I>","<I>Neotinea ustulata<\/I>","<I>Neotinea ustulata<\/I>","<I>Neotinea ustulata<\/I>","<I>Oeceoclades maculata<\/I>","<I>Oeceoclades maculata<\/I>","<I>Oeceoclades maculata<\/I>","<I>Oeceoclades maculata<\/I>","<I>Oncidium poikilostalix<\/I>","<I>Ophrys sphegodes<\/I>","<I>Orchis purpurea<\/I>","<I>Platanthera hookeri<\/I>","<I>Serapias cordigera<\/I>","<I>Serapias cordigera<\/I>","<I>Serapias cordigera<\/I>","<I>Serapias cordigera<\/I>","<I>Serapias cordigera<\/I>","<I>Serapias cordigera<\/I>","<I>Spathoglottis plicata<\/I>","<I>Telipogon helleri<\/I>","<I>Tolumnia variegata<\/I>"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-37.76,66.389444],"lng":[-123.516667,147.43]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># htmltools::save_html(Orchid_map, file = "Orchid_map.html") # El script para crear un archivo aparte del mapa</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-esperanza-de-vida-de-las-orquídeas" class="level2">
<h2 class="anchored" data-anchor-id="la-esperanza-de-vida-de-las-orquídeas">La esperanza de vida de las orquídeas</h2>
<p>Cada especies tiene un promedio de largo de vida y una distribución de supervivencia. En los humanos el largo de vida promedio es de ±72 años (y varia por país y otros factores), pero hay personas que viven hasta 100 años o más. En las orquídeas el largo de vida promedio es de 10 años, pero hay individuos que viven hasta 100 años o más. Para calcular el largo de vida y su distribuciones de una especies se usa la matriz de transición <strong>matU</strong> y la etapa de inicio de la vida <strong>start_life</strong>. La función <strong>lifeExpectancy</strong> calcula el largo de vida de una especies. Nota que este caso no se usa la matriz de fecundidad <strong>matF</strong> o la matriz de clonaje <strong>matC</strong>.</p>
<p>Para calcular y comparar los datos es importante que la matriz sea del mismo largo de tiempo, por ejemplo no se debería comparar una matriz de 1 año con una matriz de 1 mes o de 10 años. Los valores de tiempo es la unidad de los datos de la matriz.</p>
<p>Aquí el script crea un data frame de los valores del largo de vida para cada especies con matrices de transiciones de un año.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rage) <span class="co"># función para calcular el largo de vida esperada</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>lifeExpectancy <span class="ot">&lt;-</span> <span class="cf">function</span>(matU, startLife) {</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">diag</span>(<span class="fu">nrow</span>(matU)) <span class="sc">-</span> matU)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">colSums</span>(N)[startLife])</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>compadre_life_expect <span class="ot">&lt;-</span> New_Data <span class="sc">%&gt;%</span> </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ProjectionInterval <span class="sc">==</span> <span class="fl">1.0</span>) <span class="sc">|&gt;</span> <span class="co"># filtrar para matriz de un año solamente </span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MatrixComposite <span class="sc">==</span> <span class="st">"Mean"</span>, <span class="co"># filtrar para la matriz promedia</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>         MatrixTreatment <span class="sc">==</span> <span class="st">"Unmanipulated"</span>, <span class="co"># filtrar para la matriz sin manipulación</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>         MatrixCaptivity <span class="sc">==</span> <span class="st">"W"</span> <span class="co"># filtrar para poblaciones naturales (no en cautiverio)</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StageID =</span> <span class="fu">cdb_id_stages</span>(.)) <span class="sc">%&gt;%</span> <span class="co"># crear un ID para las etapas</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdb_collapse</span>(<span class="at">columns =</span> <span class="st">"StageID"</span>) <span class="sc">%&gt;%</span> <span class="co"># colapsar las etapas</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdb_flag</span>() <span class="sc">%&gt;%</span> <span class="co"># evaluar las matrices y crear una columna para cada evaluación</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(check_NA_U <span class="sc">==</span> <span class="cn">FALSE</span>, <span class="co"># filtrar para matrices sin valores faltantes</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>         check_zero_U <span class="sc">==</span> <span class="cn">FALSE</span>, <span class="co"># filtrar para matrices sin valores cero</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>         check_singular_U <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="co"># filtrar para matrices no singulares</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">matU =</span> <span class="fu">matU</span>(.), <span class="at">start_life =</span> <span class="fu">mpm_first_active</span>(.)) <span class="sc">%&gt;%</span> <span class="co"># extraer la matriz de transición y la etapa de inicio de la vida</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">life_expectancy =</span> <span class="fu">mapply</span>(lifeExpectancy, matU, start_life)) <span class="sc">%&gt;%</span> <span class="co"># calcular el largo de vida</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var_life_expectancy =</span> <span class="fu">mapply</span>(life_expect_var, matU, <span class="at">start=</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="co"># calcular la varianza del largo de vida</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">low_CI_var_LS=</span> life_expectancy<span class="fl">-1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(var_life_expectancy)) <span class="sc">%&gt;%</span> <span class="co"># calcular el intervalo de confianza inferior</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">high_CI_var_LS=</span> life_expectancy<span class="fl">+1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(var_life_expectancy)) <span class="sc">%&gt;%</span>  <span class="co"># calcular el intervalo de confianza superior</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OrganismType =</span> <span class="fu">reorder</span>(OrganismType, life_expectancy, median)) <span class="co"># ordenar las especies por el largo de vida</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 2 warnings in `mutate()`.
The first warning was:
ℹ In argument: `var_life_expectancy = mapply(life_expect_var, matU, start =
  1)`.
Caused by warning:
! Argument matU has at least one stage-specific survival.
 probability &gt; 1
ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>OrchidLS<span class="ot">=</span>compadre_life_expect <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mat, SpeciesAccepted, OrganismType, SpeciesAccepted, life_expectancy, low_CI_var_LS, high_CI_var_LS) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(life_expectancy)) <span class="co"># tabla de los resultados</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>New_Data <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ProjectionInterval <span class="sc">==</span> <span class="fl">1.0</span>) <span class="sc">|&gt;</span> <span class="co"># filtrar para matriz de un año</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(MatrixComposite <span class="sc">==</span> <span class="st">"Mean"</span>, <span class="co"># filtrar para la matriz promedia</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>         MatrixTreatment <span class="sc">==</span> <span class="st">"Unmanipulated"</span>, <span class="co"># filtrar para la matriz sin manipulación</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>         MatrixCaptivity <span class="sc">==</span> <span class="st">"W"</span> <span class="co"># filtrar para poblaciones naturales (no en cautiverio)</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">StageID =</span> <span class="fu">cdb_id_stages</span>(.)) <span class="sc">%&gt;%</span> <span class="co"># crear un ID para las etapas</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdb_collapse</span>(<span class="at">columns =</span> <span class="st">"StageID"</span>) <span class="sc">%&gt;%</span> <span class="co"># colapsar las etapas</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdb_flag</span>() <span class="sc">%&gt;%</span> <span class="co"># evaluar las matrices y crear una columna para cada evaluación</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(check_zero_C <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="co"># filtrar para matrices sin valores faltantes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A COM(P)ADRE database ('CompadreDB') object with 1 SPECIES and 2 MATRICES.

# A tibble: 2 × 74
  mat        MatrixID    SpeciesAuthor SpeciesAccepted CommonName Kingdom Phylum
  &lt;list&gt;     &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
1 &lt;CompdrMt&gt; 242609; 24… Cypripedium_… Cypripedium ca… Lady slip… Plantae Magno…
2 &lt;CompdrMt&gt; 242621      Cypripedium_… Cypripedium ca… Lady slip… Plantae Magno…
# ℹ 67 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
#   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
#   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
#   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
#   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;,
#   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;,
#   MatrixCriteriaSize &lt;chr&gt;, MatrixCriteriaOntogeny &lt;chr&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>          <span class="co"># filtrar para matrices sin valores cero</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizar el largo de vida por plantas epifitas versus terrestres. Nota aquí que algunas especies están representada múltiple veces. Por consecuencia la distribución de los datos no es una buena representación de la diferencia entre las especies epifitas y terrestres, debido a lo que se llama pseudoreplicación. Este tabla representa la distribución los datos del data frame anterior.</p>
<p>Calculando el promedio y la desviación estándar de la esperanza de vida de las orquídeas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>OrchidLS <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(OrganismType) <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_LS=</span> <span class="fu">mean</span>(life_expectancy, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_LS =</span> <span class="fu">sd</span>(life_expectancy, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  OrganismType         mean_LS sd_LS
  &lt;fct&gt;                  &lt;dbl&gt; &lt;dbl&gt;
1 Herbaceous perennial    8.26  9.27
2 Epiphyte               11.6  14.9 </code></pre>
</div>
</div>
<p>Haciendo una figura del largo de vida de las especies epífitas y terrestres. Nota que la escala es logarítmica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(OrchidLS, <span class="fu">aes</span>(OrganismType, life_expectancy, <span class="at">colour=</span>OrganismType)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Life expectancy (log(years))"</span>)<span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  rlt_theme<span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Life_Span.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<p>https://jonesor.github.io/Rage/reference/life_expect.html</p>
<p>En el siguiente script y gráfico vemos la visualización por genero de los estimados de la esperanza de vida. Nota que la esperanza de vida es un estimado y no un valor exacto. En este caso se usa la función <strong>life_expect_var</strong> para calcular la varianza de la esperanza de vida. La escala de x (el largo de vida fue cambiado a log10 de la esperanza de vida).</p>
<p><strong>How to calculate CI of life span, it is in the table above, use gamma, not normal</strong> !!!!</p>
<p>low_CI_var_LS high_CI_var_LS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SPECIES_O$SpeciesAccepted &lt;- fct_reorder(SPECIES_O$SpeciesAccepted, SPECIES_O$StudyStart, .desc = FALSE) # Ordenar por fecha de inicio del estudio </span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compadre_life_expect |&gt; select(mat, Genus, SpeciesAccepted, life_expectancy) |&gt; </span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  group_by(SpeciesAccepted) |&gt; </span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># summarize(low_CI_var_LS= life_expectancy-1.96*sqrt(var_life_expectancy),</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            high_CI_var_LS= life_expectancy+1.96*sqrt(var_life_expectancy))</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(compadre_life_expect, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(SpeciesAccepted, life_expectancy), life_expectancy, <span class="at">colour=</span>OrganismType)) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_boxplot() +</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Life expectancy (log(years))"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  rlt_theme+</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#theme(legend.position = "none")</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("Figures/Genus_Life_Span.png")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>EWl largo de vida de las Caladenia solamente</p>
<p>Evaluando el largo de vida de las especies de <em>Caladenia</em> solamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SPECIES_O$SpeciesAccepted &lt;- fct_reorder(SPECIES_O$SpeciesAccepted, SPECIES_O$StudyStart, .desc = FALSE)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>compadre_life_expect <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Genus) <span class="sc">|&gt;</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_LS=</span> <span class="fu">mean</span>(life_expectancy, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_LS =</span> <span class="fu">sd</span>(life_expectancy, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Genus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Caladenia"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Genus     mean_LS sd_LS
  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
1 Caladenia    3.90  1.64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>compadre_life_expect <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Genus <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Caladenia"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(SpeciesAccepted, life_expectancy), life_expectancy, <span class="at">colour=</span>OrganismType)) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Life expectancy (years)"</span>)<span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  rlt_theme<span class="sc">+</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="119-COMPADRE_ORCHIDS_files/figure-html/Compr40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Caladenia_Life_Span.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<p>Use robust Approach</p>
<p>Para el siguiente análisis se necesita instalar el paquete <strong>WRS2</strong>.</p>
<p>Y se necesita cargar el archivo de funciones de <strong>Rallfun-v38.txt</strong> que se encuentra en el siguiente enlace &lt;<a href="https://github.com/rrwilcox/Rallfun" class="uri">https://github.com/rrwilcox/Rallfun</a>&gt; y guardarlo en su directorio de trabajo. Pudiese ser que haya versiones más recientes de este archivo. Nota que la dirección abajo funciona para mi computadora, uds tienen que ajustar la dirección del archivo a su directorio de trabajo.</p>
<section id="calcular-el-promedio-y-la-varianza-en-la-expectativa-de-vida-de-un-modelo-de-matriz-poblacional" class="level3">
<h3 class="anchored" data-anchor-id="calcular-el-promedio-y-la-varianza-en-la-expectativa-de-vida-de-un-modelo-de-matriz-poblacional">Calcular el promedio y la varianza en la expectativa de vida de un modelo de matriz poblacional</h3>
<p>http://127.0.0.1:29465/rmd_output/1/compadre_orchid-ppm-y-su-uso.html</p>
<p>Revisión RLT:</p>
<p>Sept 15, 2024</p>
<p>Jan 20, 2025</p>



</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tremblay2014bayesian" class="csl-entry" role="listitem">
Tremblay, Raymond L, and Michael A McCarthy. 2014. <span>“Bayesian Estimates of Transition Probabilities in Seven Small Lithophytic Orchid Populations: Maximizing Data Availability from Many Small Samples.”</span> <em>PLoS One</em> 9 (7): e102859.
</div>
<div id="ref-tremblay2001gene" class="csl-entry" role="listitem">
Tremblay, RL, and JD Ackerman. 2001. <span>“Gene Flow and Effective Population Size in <em>Lepanthes</em> (Orchidaceae): A Case for Genetic Drift.”</span> <em>Biological Journal of the Linnean Society</em> 72 (1): 47–62. <a href="https://doi.org/10.1006/bijl.2000.0485">https://doi.org/10.1006/bijl.2000.0485</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./116-Estudio_evolutivos.qmd" class="pagination-link" aria-label="Estudios evolutivos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Estudios evolutivos</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./120-Traduccion_protocolo_informacion.html" class="pagination-link" aria-label="Traducción del protocolo de información">
        <span class="nav-page-text">Traducción del protocolo de información</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Raymond L. Tremblay</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>